import{_ as x,o as c,c as f,F as E,r as M,a as e,n as O,d as U,b as N,t as $,e as P,f as g,s as A,w as D,g as v,h as w,i as y,u as C,j as V,v as z,k as K,l as H,m as L,p as q,q as F,x as J}from"./index-CRzpeYjB.js";const W={},X={class:"inline-block text-left min-w-8 px-4 py-3"};function Y(t,s){return c(),f("span",X,[(c(),f(E,null,M(3,n=>e("span",{key:n,class:O(`dot dot-${n}`)},"•",2)),64))])}const G=x(W,[["render",Y],["__scopeId","data-v-130ebac5"]]),Q={key:1,class:"bubble"},Z={key:0},ee={key:1},se=U({__name:"MessageRow",props:{message:{}},setup(t){return(s,n)=>(c(),f("article",{class:O(["message-row",[s.message.isUser?"user":"assistant"]])},[s.message.isInteracting?(c(),N(G,{key:0})):(c(),f("div",Q,[s.message.isUser?(c(),f("p",Z,$(s.message.sendText),1)):(c(),f("p",ee,$(s.message.responseText),1))]))],2))}}),te=x(se,[["__scopeId","data-v-d799c959"]]),ae="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",oe="https://openrouter.ai/api/v1/chat/completions";function ne(){async function*t(s,n={}){var b,m,T;const{model:u="tngtech/deepseek-r1t-chimera:free",apiKey:_=ae,referer:l="",title:r=""}=n;if(!_)throw new Error("OpenRouter API key is required");const o={Authorization:`Bearer ${_}`,"Content-Type":"application/json"};l&&(o["HTTP-Referer"]=l),r&&(o["X-Title"]=r);const a=await fetch(oe,{method:"POST",headers:o,body:JSON.stringify({model:u,messages:s,stream:!0})});if(!a.body)throw new Error("Нет ответа от сервера");const i=a.body.getReader(),p=new TextDecoder;let d=!1,h="";for(;!d;){const{value:j,done:B}=await i.read();d=B,h+=p.decode(j||new Uint8Array,{stream:!d});const R=h.split(`
`);h=R.pop()||"";for(const I of R)if(I.startsWith("data: ")){const S=I.slice(6);if(S==="[DONE]")return;try{yield((T=(m=(b=JSON.parse(S).choices)==null?void 0:b[0])==null?void 0:m.delta)==null?void 0:T.reasoning)||""}catch{}}}}return{sendMessageStream:t}}const re=P("chat",()=>{const t=g([]),s=g(""),n=g(!1),{sendMessageStream:u}=ne();async function _(){if(!s.value.trim())return;const l=s.value;s.value="",n.value=!0;const r=Date.now().toString();t.value.push({id:`${r}-user`,sendText:l,responseText:"",isInteracting:!1,isUser:!0});try{const o=u([{role:"user",content:l}]);t.value.push({id:`${r}-assistant`,sendText:l,responseText:"",isInteracting:!0,isUser:!1});const a=t.value.find(i=>i.id===`${r}-assistant`);for await(const i of o){if(!a)return;a.isInteracting=!1,a.responseText+=i}}catch(o){const a=t.value.find(i=>i.id===`${r}-assistant`);a&&(a.isError=o.message||"Error")}finally{const o=t.value.find(a=>a.id===`${r}-assistant`);o&&(o.isInteracting=!1),n.value=!1}}return{messages:t,inputMessage:s,isInteracting:n,sendMessage:_}}),k=t=>(F("data-v-7eeb4bb7"),t=t(),J(),t),ie={class:"chat-view"},ce={class:"h-full flex flex-col px-4 md:px-6 lg:px-8"},le=k(()=>e("div",{class:"py-5 bg-white sticky top-0 z-10 before:absolute before:inset-x-0 before:bottom-0 before:h-px before:bg-gradient-to-r before:from-black/[0.06] before:via-black/10 before:to-black/[0.06]"},[e("div",{class:"flex items-center justify-between gap-2"},[e("nav",{"aria-label":"breadcrumb"},[e("ol",{class:"text-gray-500 flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-1.5"},[e("li",{class:"inline-flex items-center gap-1.5"},[e("a",{class:"hover:text-gray-600 transition-colors",href:"#"},"Playground")]),e("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"m9 18 6-6-6-6"})])]),e("li",{"data-slot":"breadcrumb-item",class:"inline-flex items-center gap-1.5"},[e("span",{"aria-disabled":"true",class:"text-gray-600 font-normal"},"Chat")])])])])],-1)),de=k(()=>e("div",{class:"my-8"},null,-1)),fe={class:"messages"},ue={class:"sticky bottom-0 pt-4 md:pt-8 z-50"},pe={class:"mx-auto bg-white rounded-2xl pb-4 md:pb-8"},me=["onKeydown"],_e={class:"flex items-center justify-between gap-2 p-3"},he=k(()=>e("div",{class:"flex items-center gap-2"},null,-1)),ge={class:"flex items-center gap-2"},be=U({__name:"ChatView",setup(t){const s=re(),{messages:n,inputMessage:u,isInteracting:_}=A(s),{sendMessage:l}=s,r=g(),o=g(),a=()=>{_.value||l()};return D(()=>n,()=>{var p;const i=(p=r.value)==null?void 0:p.clientHeight;i&&setTimeout(()=>{var d;(d=o.value)==null||d.setScrollTop(i)},0)},{deep:!0}),(i,p)=>{const d=y("el-button"),h=y("el-form"),b=y("el-scrollbar");return c(),f("div",ie,[v(b,{ref_key:"scrollbarRef",ref:o},{default:w(()=>[e("div",ce,[e("div",{ref_key:"innerRef",ref:r,class:"relative grow"},[le,de,e("div",fe,[(c(!0),f(E,null,M(C(n),m=>(c(),N(te,{key:m.id,message:m},null,8,["message"]))),128))])],512),e("div",ue,[e("div",pe,[v(h,{class:"bottom-bar"},{default:w(()=>[V(e("textarea",{"onUpdate:modelValue":p[0]||(p[0]=m=>K(u)?u.value=m:null),placeholder:"Ask me anything...",id:"message",rows:1,autocomplete:"off",onKeydown:H(L(a,["prevent"]),["enter"])},null,40,me),[[z,C(u)]]),e("div",_e,[he,e("div",ge,[v(d,{class:"shadow-sm h-6",type:"primary",size:"default",round:"",onClick:a},{default:w(()=>[q(" Ask Bart ")]),_:1})])])]),_:1})])])])]),_:1},512)])}}}),ye=x(be,[["__scopeId","data-v-7eeb4bb7"]]);export{ye as default};
