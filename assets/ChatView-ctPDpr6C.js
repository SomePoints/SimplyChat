import{_ as x,o as c,c as f,F as O,r as $,a as e,n as M,d as U,b as P,t as I,e as A,f as g,s as B,w as V,g as v,h as w,i as y,u as C,j,v as K,k as z,l as L,m as H,p as q,q as F,x as J}from"./index-BHz6j8yk.js";const Y={},W={class:"inline-block text-left min-w-8 px-4 py-3"};function X(t,s){return c(),f("span",W,[(c(),f(O,null,$(3,n=>e("span",{key:n,class:M(`dot dot-${n}`)},"•",2)),64))])}const G=x(Y,[["render",X],["__scopeId","data-v-130ebac5"]]),Q={key:1,class:"bubble"},Z={key:0},ee={key:1},se=U({__name:"MessageRow",props:{message:{}},setup(t){return(s,n)=>(c(),f("article",{class:M(["message-row",[s.message.isUser?"user":"assistant"]])},[s.message.isInteracting?(c(),P(G,{key:0})):(c(),f("div",Q,[s.message.isUser?(c(),f("p",Z,I(s.message.sendText),1)):(c(),f("p",ee,I(s.message.responseText),1))]))],2))}}),te=x(se,[["__scopeId","data-v-d799c959"]]);var ae={BASE_URL:"/SimplyChat/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const oe=ae.VITE_OPENROUTER_API_KEY,ne="https://openrouter.ai/api/v1/chat/completions";function re(){async function*t(s,n={}){var b,_,R;const{model:u="tngtech/deepseek-r1t-chimera:free",apiKey:m=oe,referer:l="",title:r=""}=n;if(!m)throw new Error("OpenRouter API key is required");const o={Authorization:`Bearer ${m}`,"Content-Type":"application/json"};l&&(o["HTTP-Referer"]=l),r&&(o["X-Title"]=r);const a=await fetch(ne,{method:"POST",headers:o,body:JSON.stringify({model:u,messages:s,stream:!0})});if(!a.body)throw new Error("Нет ответа от сервера");const i=a.body.getReader(),p=new TextDecoder;let d=!1,h="";for(;!d;){const{value:D,done:N}=await i.read();d=N,h+=p.decode(D||new Uint8Array,{stream:!d});const T=h.split(`
`);h=T.pop()||"";for(const E of T)if(E.startsWith("data: ")){const S=E.slice(6);if(S==="[DONE]")return;try{yield((R=(_=(b=JSON.parse(S).choices)==null?void 0:b[0])==null?void 0:_.delta)==null?void 0:R.reasoning)||""}catch{}}}}return{sendMessageStream:t}}const ie=A("chat",()=>{const t=g([]),s=g(""),n=g(!1),{sendMessageStream:u}=re();async function m(){if(!s.value.trim())return;const l=s.value;s.value="",n.value=!0;const r=Date.now().toString();t.value.push({id:`${r}-user`,sendText:l,responseText:"",isInteracting:!1,isUser:!0});try{const o=u([{role:"user",content:l}]);t.value.push({id:`${r}-assistant`,sendText:l,responseText:"",isInteracting:!0,isUser:!1});const a=t.value.find(i=>i.id===`${r}-assistant`);for await(const i of o){if(!a)return;a.isInteracting=!1,a.responseText+=i}}catch(o){const a=t.value.find(i=>i.id===`${r}-assistant`);a&&(a.isError=o.message||"Error")}finally{const o=t.value.find(a=>a.id===`${r}-assistant`);o&&(o.isInteracting=!1),n.value=!1}}return{messages:t,inputMessage:s,isInteracting:n,sendMessage:m}}),k=t=>(F("data-v-7eeb4bb7"),t=t(),J(),t),ce={class:"chat-view"},le={class:"h-full flex flex-col px-4 md:px-6 lg:px-8"},de=k(()=>e("div",{class:"py-5 bg-white sticky top-0 z-10 before:absolute before:inset-x-0 before:bottom-0 before:h-px before:bg-gradient-to-r before:from-black/[0.06] before:via-black/10 before:to-black/[0.06]"},[e("div",{class:"flex items-center justify-between gap-2"},[e("nav",{"aria-label":"breadcrumb"},[e("ol",{class:"text-gray-500 flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-1.5"},[e("li",{class:"inline-flex items-center gap-1.5"},[e("a",{class:"hover:text-gray-600 transition-colors",href:"#"},"Playground")]),e("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"m9 18 6-6-6-6"})])]),e("li",{"data-slot":"breadcrumb-item",class:"inline-flex items-center gap-1.5"},[e("span",{"aria-disabled":"true",class:"text-gray-600 font-normal"},"Chat")])])])])],-1)),fe=k(()=>e("div",{class:"my-8"},null,-1)),ue={class:"messages"},pe={class:"sticky bottom-0 pt-4 md:pt-8 z-50"},_e={class:"mx-auto bg-white rounded-2xl pb-4 md:pb-8"},me=["onKeydown"],he={class:"flex items-center justify-between gap-2 p-3"},ge=k(()=>e("div",{class:"flex items-center gap-2"},null,-1)),be={class:"flex items-center gap-2"},ve=U({__name:"ChatView",setup(t){const s=ie(),{messages:n,inputMessage:u,isInteracting:m}=B(s),{sendMessage:l}=s,r=g(),o=g(),a=()=>{m.value||l()};return V(()=>n,()=>{var p;const i=(p=r.value)==null?void 0:p.clientHeight;i&&setTimeout(()=>{var d;(d=o.value)==null||d.setScrollTop(i)},0)},{deep:!0}),(i,p)=>{const d=y("el-button"),h=y("el-form"),b=y("el-scrollbar");return c(),f("div",ce,[v(b,{ref_key:"scrollbarRef",ref:o},{default:w(()=>[e("div",le,[e("div",{ref_key:"innerRef",ref:r,class:"relative grow"},[de,fe,e("div",ue,[(c(!0),f(O,null,$(C(n),_=>(c(),P(te,{key:_.id,message:_},null,8,["message"]))),128))])],512),e("div",pe,[e("div",_e,[v(h,{class:"bottom-bar"},{default:w(()=>[j(e("textarea",{"onUpdate:modelValue":p[0]||(p[0]=_=>z(u)?u.value=_:null),placeholder:"Ask me anything...",id:"message",rows:1,autocomplete:"off",onKeydown:L(H(a,["prevent"]),["enter"])},null,40,me),[[K,C(u)]]),e("div",he,[ge,e("div",be,[v(d,{class:"shadow-sm h-6",type:"primary",size:"default",round:"",onClick:a},{default:w(()=>[q(" Ask Bart ")]),_:1})])])]),_:1})])])])]),_:1},512)])}}}),xe=x(ve,[["__scopeId","data-v-7eeb4bb7"]]);export{xe as default};
